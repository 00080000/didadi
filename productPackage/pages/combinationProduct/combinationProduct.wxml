<!-- pages/combinationProduct/combinationProduct.wxml -->
<view class="container">
  <!-- 上方的Logo与文字提示部分 -->
  <view class="topArea">
    <view>
      <header></header>
      <view class="options">
        <view class="singleProoductOption" bind:tap="goToSingleProoduct">
          单商品库
        </view>
        <view class="divide" style="margin-right: 20rpx;"></view>
        <view class="chooseOption">
          组合商品库
        </view>
        <view class="divide" style="margin-left: 20rpx;"></view>
        <view class="temporaryProoductOption" bind:tap="goToTemporaryProoduct">
          临时商品库
        </view>
      </view>
    </view>
    
    <!-- 优化后的搜索区域 -->
    <view class="search">
      <form catchsubmit="inputProduct">
      <view style="display: flex;align-items: center;">
        <view class="inputArea">
          <image src="/static/search.png"></image>
          <view style="display: flex;align-items: center;">
            <!-- 使用bindinput实时监听输入 -->
            <input 
              bindinput="onInput" 
              value="{{keyword}}" 
              style="width: 250rpx;" 
              placeholder="输入名称关键字" 
            />
          </view>
        </view>
        <!-- 保留搜索按钮，点击时也触发搜索 -->
        <button bind:tap="onSearch" size="mini" style="font-size: 32rpx;">搜索</button>
      </view>
            
      <!-- 错误信息显示（确保只显示字符串） -->
      <view class="errorMsg" wx:if="{{errorMsg}}">
        {{errorMsg}}
      </view>
    </form>
    </view>
 
  </view>

  <!-- 商品列表区域 -->
  <view class="productList">
    <!-- 无数据提示 -->
    <view class="emptyList" wx:if="{{!filterProduct.length && !isLoading}}">
      <text>暂无数据</text>
    </view>
    
    <!-- 商品列表 -->
    <view class="productCard" wx:for="{{filterProduct}}" wx:key="index" wx:for-item="item">
      <view class="cardLeft">
        <view class="sideBar"></view>
        <view class="information">
          <view style="font-size: 25rpx;">组合商品名称：{{item.name}}</view>
          <view style="font-size: 20rpx; color: #888;">编码：{{item.code}}</view>
        </view>
      </view>
      <view class="operation">
        <button size="mini" bind:tap="goToViewProduct" data-index="{{index}}">查看</button>
        <image src="/static/delete.png" bind:tap="confirmDelete"></image>
      </view>
    </view>
  </view>

  <!-- 底部导航栏 -->
  <view class="tabBar">
    <view class="notSelectedNavigateBar" bind:tap="navigateToMain">
      <image mode="heightFix" src="/static/home-gray.png"></image>
      首页
    </view>
    <view class="notSelectedNavigateBar" bind:tap="navigateToPrice">
      <image mode="heightFix" src="/static/price-gray.png"></image>
      询报价
    </view>
    <view class="selectedNavigateBar">
      <image mode="heightFix" src="/static/product-blue.png"></image>
      商品
    </view>
    <view class="notSelectedNavigateBar" bind:tap="navigateToMerchant">
      <image mode="heightFix" src="/static/merchant-gray.png"></image>
      商家
    </view>
  </view>
</view>